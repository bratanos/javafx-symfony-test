<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<BorderPane xmlns="http://javafx.com/javafx/21"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.innertrack.controller.ArticleController"
            styleClass="main-container"
            stylesheets="@../css/components/style.css">

    <padding>
        <Insets top="20" right="20" bottom="20" left="20"/>
    </padding>

    <!-- TOP: Title Section -->
    <top>
        <HBox alignment="CENTER_LEFT" spacing="15">
            <padding>
                <Insets bottom="20"/>
            </padding>
            <Label text="ðŸ“°" style="-fx-font-size: 42px;"/>
            <VBox>
                <Label text="Gestion des Articles" styleClass="page-title"/>
                <Label text="CrÃ©ez, modifiez et consultez vos articles" styleClass="page-subtitle"/>
            </VBox>
        </HBox>
    </top>

    <!-- CENTER: Main Content -->
    <center>
        <ScrollPane fitToWidth="true" fitToHeight="true"
                    hbarPolicy="AS_NEEDED" vbarPolicy="AS_NEEDED"
                    style="-fx-background: transparent; -fx-background-color: transparent;">
            <content>
                <HBox spacing="20" styleClass="content-area" minWidth="900">
                    <padding>
                        <Insets top="20" right="20" bottom="20" left="20"/>
                    </padding>

                    <!-- ========================================
                         LEFT PANEL: FORM (IMPROVED)
                         ======================================== -->
                    <VBox spacing="15" prefWidth="420" styleClass="form-panel">
                        <padding>
                            <Insets top="20" right="20" bottom="20" left="20"/>
                        </padding>

                        <Label text="Formulaire Article"
                               style="-fx-font-size: 18px; -fx-font-weight: bold; -fx-text-fill: #2c3e50;"/>
                        <Separator/>

                        <!-- Titre Field -->
                        <Label text="Titre de l'article:"
                               style="-fx-font-size: 13px; -fx-font-weight: 600;"/>
                        <TextField fx:id="tfTitre"
                                   promptText="Ex: Les bienfaits de la mÃ©ditation"
                                   style="-fx-pref-height: 38px;"/>

                        <!-- Auteur Field -->
                        <Label text="Auteur:"
                               style="-fx-font-size: 13px; -fx-font-weight: 600;"/>
                        <TextField fx:id="tfAuteur"
                                   promptText="Ex: Dr Sophie Martin"
                                   style="-fx-pref-height: 38px;"/>

                        <!-- Date Field -->
                        <Label text="Date de publication:"
                               style="-fx-font-size: 13px; -fx-font-weight: 600;"/>
                        <DatePicker fx:id="dpDatePublication"
                                    promptText="SÃ©lectionner une date"
                                    prefWidth="380"
                                    style="-fx-pref-height: 38px;"/>

                        <!-- CatÃ©gorie Field -->
                        <Label text="CatÃ©gorie:"
                               style="-fx-font-size: 13px; -fx-font-weight: 600;"/>
                        <ComboBox fx:id="cbCategorie"
                                  promptText="Choisir une catÃ©gorie"
                                  prefWidth="380"
                                  style="-fx-pref-height: 38px;"/>

                        <!-- Contenu Field -->
                        <Label text="Contenu:"
                               style="-fx-font-size: 13px; -fx-font-weight: 600;"/>
                        <TextArea fx:id="taContenu"
                                  promptText="Ã‰crivez le contenu de votre article ici..."
                                  wrapText="true"
                                  prefHeight="160"
                                  style="-fx-font-size: 13px;"/>

                        <Separator/>

                        <!-- Buttons Row 1 -->
                        <HBox spacing="10" alignment="CENTER">
                            <Button fx:id="btnAdd"
                                    text="âž• Ajouter"
                                    onAction="#handleAdd"
                                    styleClass="btn-primary"
                                    prefWidth="180"
                                    prefHeight="38"/>

                            <Button fx:id="btnUpdate"
                                    text="âœï¸ Modifier"
                                    onAction="#handleUpdate"
                                    styleClass="btn-secondary"
                                    prefWidth="180"
                                    prefHeight="38"/>
                        </HBox>

                        <!-- Buttons Row 2 -->
                        <HBox spacing="10" alignment="CENTER">
                            <Button fx:id="btnDelete"
                                    text="ðŸ—‘ï¸ Supprimer"
                                    onAction="#handleDelete"
                                    styleClass="btn-danger"
                                    prefWidth="180"
                                    prefHeight="38"/>

                            <Button fx:id="btnClear"
                                    text="ðŸ”„ Vider"
                                    onAction="#clearForm"
                                    styleClass="btn-info"
                                    prefWidth="180"
                                    prefHeight="38"/>
                        </HBox>
                    </VBox>

                    <!-- ========================================
                         RIGHT PANEL: TABLE + PREVIEW
                         ======================================== -->
                    <VBox spacing="15" HBox.hgrow="ALWAYS" minWidth="500">

                        <!-- Search Bar -->
                        <HBox spacing="10" alignment="CENTER_LEFT">
                            <TextField fx:id="tfSearch"
                                       promptText="ðŸ” Rechercher par titre, auteur, catÃ©gorie..."
                                       prefWidth="380"
                                       style="-fx-pref-height: 38px;"/>
                            <Button text="Actualiser"
                                    onAction="#handleRefresh"
                                    styleClass="btn-success"
                                    prefHeight="38"/>
                        </HBox>

                        <!-- Table -->
                        <TableView fx:id="tableArticles" VBox.vgrow="ALWAYS">
                            <columns>
                                <TableColumn fx:id="colTitre" text="Titre" prefWidth="180"/>
                                <TableColumn fx:id="colAuteur" text="Auteur" prefWidth="140"/>
                                <TableColumn fx:id="colCategorie" text="CatÃ©gorie" prefWidth="120"/>
                                <TableColumn fx:id="colDate" text="Date" prefWidth="100"/>
                                <TableColumn fx:id="colContenu" text="AperÃ§u" prefWidth="200"/>
                            </columns>
                            <columnResizePolicy>
                                <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                            </columnResizePolicy>
                        </TableView>

                        <!-- Preview Box -->
                        <VBox spacing="5" styleClass="preview-box">
                            <Label text="ðŸ“– AperÃ§u de l'article sÃ©lectionnÃ©"
                                   styleClass="section-title"/>
                            <TextArea fx:id="taPreview"
                                      editable="false"
                                      wrapText="true"
                                      prefHeight="120"
                                      styleClass="preview-area"/>
                        </VBox>
                    </VBox>
                </HBox>
            </content>
        </ScrollPane>
    </center>
</BorderPane>